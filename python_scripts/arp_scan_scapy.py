#!/usr/bin/python
from scapy.all import *

def arp_scan(ip):
	arp_req = Ether(dst="ff:ff:ff:ff:ff:ff")/ARP(pdst=ip, hwdst="ff:ff:ff:ff:ff:ff")
	arp_resp = srp1(arp_req, timeout=1, verbose=0)
	if arp_resp:
		print ip + " ===> " + arp_resp.hwsrc

def proc_addr():
	result = ""
	for j in ip_address:
		result+=str(ip_address[j])
		if j < 3:
			result+="."
	arp_scan(result)

def constr_addr(count):
	if count == 4:
		proc_addr()
	else:
        	for i in range(0, 256-int(octet[count])):
			ip_address[count] = int(net_addr[count]) + i
			constr_addr(count+1)
			
ip_address = {}
net_addr = ['192', '168', '1', '0']
octet = ['255', '255', '255', '0']

constr_addr(0)

